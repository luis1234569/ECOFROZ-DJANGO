{% extends 'base.html' %}
{% load tz %}

{% block extrahead %}

<style type="text/css"> 
  thead th  { 
      position: sticky;
      top: 0;
      z-index: 10;
      background-color: #ffffff;
      border: blue 2px solid;
      
  }

  tr td  { 
      
      border: rgb(209, 209, 226) 1px solid;
      
  }

  .table { 
      height:200px;
      overflow:scroll;
      font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
      border-collapse: collapse;
      width: 100%;
  }

  

  th, td {
    word-wrap: break-word;
    text-align: left;
   padding: 8px;
}

</style>

{% endblock %}



{% block content %}
<div class="container" style="margin: 25px auto;">
  <div class="row">

      <form class="form-inline my-2 my-lg-0" method="GET" action="{% url 'procesosadministrativos:reporte_raytec' %}" id="buscar" name="buscar">

          <div class="form-group col-auto">
            <label style="margin-right: 10px;">DESDE:</label>
            <input type="date" name="inicio" value="{{ inicio }}" required>
          </div>
          <div class="form-group col-auto">
            <label style="margin-right: 10px;">HASTA:</label>
            <input type="date" name="fin" value="{{ fin }}" required>
          </div>
          <div class="form-group col-auto">
            <input type="checkbox"  name="l1" id="l1"> <label for="l1">&nbsp;Línea 1&nbsp;</label>
            <input type="checkbox"  name="l2" id="l2"> <label for="l2">&nbsp;Línea 2&nbsp;</label>
            <input type="checkbox"  name="l3" id="l3"> <label for="l3">&nbsp;Línea 3&nbsp;</label>
          </div>
          <div class="form-group col-auto">
            <div class="col-auto">
            <button class="btn btn-secondary my-2 my-sm-0" type="submit">Buscar</button>
            <a class="btn btn-warning my-2 my-sm-0"  href="{% url 'procesosadministrativos:reporte_raytec' %}">Limpiar</a>
        </div>
      </form>

        <div class="col">
          {% if inicio == 'None' and fin == 'None' %}
          <a class="btn btn-outline-secondary" id="excel-dis" style="align-items: right;" href="">Exportar a Excel</a> 
          {% else %}
          <a class="btn btn-outline-success" style="align-items: right;" href="{% url 'procesosadministrativos:export_excel' inicio fin %}">Exportar a Excel</a> 
          {% endif %}
        </div>

     


      </form>
    </div>
  </div>
  </div>

 

  <table class="table table-striped table-sm" style="margin: 25px auto; width: 100%;">
    <thead class="thead-dark">
      <tr>
                <th>N°</th>
                <th>Proceso</th>
                <th>Eyector</th>
                <th>Peso(mg)</th>
                <th>Pixels</th>
                <th>Defecto</th>
                <th>Receta</th> 
                <th>Línea</th>
                <th>Fecha</th>
                <th>Inicia Proc</th>
                <th>Finaliza Proc</th>
                
                
            </tr>
        </thead>
        <tbody style="text-align: center;">
            {% for i in reg %}
            <tr>
                <td>{{ forloop.counter0 |add:reg.start_index }}</td>
                <td>{{ i.proceso | default:"--" }}</td>
                <td>{{ i.counter }}</td>
                <td>{{ i.weight }}</td>
                <td>{{ i.pixels }}</td>
                <td>{{ i.defecto | default:"--"}}</td>
                <td>{{ i.receta | default:"--" }}</td>
                <td>{{ i.linea | default:"--" }}</td>
                
                <td>{{ i.time | timezone:"UTC" }}</td>
                
                <td>{{ i.usuini | default:"--" }}</td>
                <td>{{ i.usufin | default:"--" }}</td>
            
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
<div class="pagination">
  <span class="step-links">
      {% if reg.has_previous %}
          <a href="?inicio={{ inicio }}&fin={{ fin }}&page=1">&laquo; inicio</a>
          <a href="?inicio={{ inicio }}&fin={{ fin }}&page={{ reg.previous_page_number }}">previo</a>
      {% endif %}

      <span class="current">
          Page {{ reg.number }} of {{ reg.paginator.num_pages }}.
      </span>

      {% if reg.has_next %}
          <a href="?inicio={{ inicio }}&fin={{ fin }}&page={{ reg.next_page_number }}">próximo</a>
          <a href="?inicio={{ inicio }}&fin={{ fin }}&page={{ reg.paginator.num_pages }}">último &raquo;</a>
      {% endif %}
  </span>
</div>
{% endblock %}

{% block extrajs %}
<script>
var comprueba = '{{msje2}}'
if (comprueba == 'Error') {
  $(document).ready(function(){
    alert('{{ msje }}');
  })
};



$("#excel-dis").click(function(){
   
    alert("Debe seleccionar un rango de fechas válido");
    
    return true;
    });

</script>
{% endblock %}