
{% extends 'base.html' %}
{% load bootstrap %}
{% load widget_tweaks %}

{% block extrahead %}

<style>
  body {
        background-color:cadetblue
      }

  th, td {
  text-align: left;
  padding: 8px;
}
</style>

{% endblock %}

{% block content %}



{% for nombre in proveedor %}  
{% if messages %}

    <div class="row">
      <div class="col-sm">
        
      </div>
      <div class="col-sm">
        {% for message in messages %}
      <p{% if message.tags %} class="{{ message.tags }}"{% endif %} style="text-align: center;background-color:#17a2b8;color:white;font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;">{{ message }}</p>
      {% endfor %}
      </div>
      <div class="col-sm">
        
      </div>
    </div>
  
  {% endif %}

<div class="container-fluid" style="margin-top: 15px">
  <a href="{% url  'proveedores:ver_documentos' nombre.codigo_id.id  %}"  style="margin-left:80px;" class="btn btn-outline-primary">Regresar a Documentos del Proveedor</a>
  <pre></pre>
<div class="row">
  <div class=".col-12">
    <div class="row">
    <h4 style="margin-left:85px;">Fichas de {{ nombre.codigo_id.nombre_empresa }}</h4>
    
      
      <div class="row" style="margin-left:60px;" id="fila_fechas" >
        <form action="{% url 'proveedores:actualiza_fecha_update_ficha' %}" method="GET" id="form">
          {% csrf_token %}  
        <div class="col-8"> 
            <label for="date" style="margin-right: 10px;">FECHA ULTIMA ACTUALIZACION:</label>
            <input type="date" name="fecha_actualiza" value="{{ fecha_cargados }}" onChange="form.submit();">
            <input type="text" name="cod" value="{{nombre.codigo_id.id}}" hidden>
          </div>
        </form>
          
  
      </div>
    <h6 style="margin-left:85px;">Actualizado Por:&nbsp;{{record.actualiza | default:"--"}}</h6>

    </div>
    
    <!-- <div class="row">
    <a style="margin-left: 100px;" class="btn btn-outline-success" title="Volver a Documentos del Proveedor" href="{% url 'proveedores:ver_documentos' nombre.codigo_id.id %}"><b>Volver a Documentos del Proveedor</b></a>
    </div>   -->
  </div>
 
</div>
    
    
  {% endfor %}
  

<div class="container p-3 my-3 bg-dark text-white" style="width: 91%; margin-top: 5px;">
  
  <br>
    
  <div class="well text-muted text-center" style="padding-top: 0rem; padding-bottom: 0rem;">
    <span class="glyphicon glyphicon-arrow-down" style="font-size: 2rem;"></span>
    <h3>Arrastre las Fichas aqu√≠</h3>
  </div>
</div>
    
    <div class="modal fade" id="modal-progress" data-backdrop="static" data-keyboard="false">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title">Uploading...</h4>
          </div>
          <div class="modal-body">
            <div class="progress">
              <div class="progress-bar" role="progressbar" style="width: 0%;">0%</div>
            </div>
          </div>
        </div>
      </div>
    </div>


    <!-- <button type="button" class="btn btn-primary js-upload-photos">
      <span class="glyphicon glyphicon-cloud-upload"></span> Upload documentos
    </button>
    </div> -->
    
    {# 2. FILE INPUT TO BE USED BY THE PLUG-IN #}
    {% for empresa in proveedor %}
    <input id="fileupload" type="file" name="archivos" multiple
           style="display: none;"
           data-url="{% url 'proveedores:ver_fichas' empresa.codigo_id.id %}"
           data-form-data='{"csrfmiddlewaretoken": "{{ csrf_token }}"}'>
    {% endfor %}

    {# 3. TABLE TO DISPLAY THE UPLOADED DOCS #}
    <div class="container"  style="width: 95%; margin-top: 25px;">
    <table id="gallery" class="table table-bordered">
      <thead>
        <tr>
          <th style="width: 5%;">No</th>
          <th>Fichas Enviadas</th>
          <th>Opciones</th>
        </tr>
      </thead>
      <tbody>
        {% for documento in documentos_list %}
          <tr>
            <td style="width: 5%;"><strong>{{ forloop.counter }}</strong></td>
            <!-- <td><a href="{{ documento.archivos.url }}">{{ documento.archivos.name }}</a></td> -->
            {% if documento.nombre_corto %} 
            <td><a href="{{ documento.archivos.url }}">{{ documento.nombre_corto }}</a></td>
            {% else %}
            <td><a href="{{ documento.archivos.url }}">{{ documento.archivos.name }}</a></td> 
            {% endif %}
            <td><a class="btn btn-danger glyphicon glyphicon-trash" title="Eliminar" href="{% url 'proveedores:eliminar_documentos' documento.id documento.proveedor.id %}"></a></td> 
          
          </tr>
        {% endfor %}
      </tbody>
    </table>
    <p>
      

  {# 4. TABLA PARA MOSTRAR FICHAS PENDIENTES DE ENTREGA (SI LAS HAY) #}
  <p><strong>Fichas Pendientes de Entrega</strong></p>
  <table id="gallery" class="table table-bordered">
    <thead>
      {% for ficha in fichas_pendientes %}
        <tr>
          <td style="width: 5%;"><strong>{{ forloop.counter }}</strong></td>
            <td>{{ ficha.nombre_ficha }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  




  
  </div>
    
    


{% endblock content %}


{% block extrajs %}
{% load static %}

<script src="{% static 'js/jquery-3.1.1.min.js' %}"></script>
<script src="{% static 'js/bootstrap.min.js' %}"></script>

<script src="{% static 'js/jquery-file-upload/js/vendor/jquery.ui.widget.js' %}"></script>
<script src="{% static 'js/jquery-file-upload/js/jquery.iframe-transport.js' %}"></script>
<script src="{% static 'js/jquery-file-upload/js/jquery.fileupload.js' %}"></script>

<script src="{% static 'js/basic-upload.js' %}"></script>



{% endblock %}